<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.Circle?>

<AnchorPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="app.controllers.DashboardController"
            style="-fx-background-color: #f8fafc;">

    <children>
        <!-- âœ… SIDEBAR DRAWER -->
        <VBox fx:id="sidebarDrawer" spacing="0" prefWidth="280" maxWidth="280"
              style="-fx-background-color: white; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 0);"
              AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0">

            <!-- Drawer Header -->
            <VBox spacing="10" style="-fx-background-color: #2C3E50; -fx-padding: 25 20 20 20;">
                <HBox alignment="CENTER_LEFT" spacing="12">
                    <StackPane xmlns:fx="http://javafx.com/fxml"
                               style="-fx-background-color: white; -fx-background-radius: 15; -fx-padding: 10;">
                        <ImageView fitHeight="40" fitWidth="40" preserveRatio="true">
                            <image>
                                <Image url="@/images/colord_logo.png"/>
                            </image>
                        </ImageView>
                    </StackPane>

                    <VBox alignment="CENTER_LEFT" spacing="2">
                        <Label text="CHEM TECH"
                               style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: white;"/>
                        <Label text="Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"
                               style="-fx-font-size: 11px; -fx-text-fill: #c7d2fe; -fx-font-weight: 500;"/>
                    </VBox>
                </HBox>

                <!-- User Info in Sidebar -->
                <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 10 0 0 0;">
                    <StackPane style="-fx-background-color: #374151; -fx-background-radius: 20; -fx-padding: 6;">
                        <Label text="ðŸ‘¤" style="-fx-font-size: 12px;"/>
                    </StackPane>
                    <Label fx:id="loggedUserLabel" text="Ù…Ø±Ø­Ø¨Ø§Ù‹: "
                           style="-fx-text-fill: white; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                </HBox>
            </VBox>

            <!-- Quick Actions in Sidebar -->
            <VBox spacing="0" style="-fx-padding: 20 0 20 0;">
                <Label text="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©"
                       style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: bold; -fx-padding: 0 20 15 20;"/>

                <VBox spacing="8" style="-fx-padding: 0 15 0 15;">
                    <!-- Quick Action Buttons -->
                    <Button text="âž• Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯" onAction="#openAddItemPage"
                            style="-fx-background-color: transparent; -fx-text-fill: #059669; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #d1fae5; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ“¦ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†" onAction="#openInventoryManagement"
                            style="-fx-background-color: transparent; -fx-text-fill: #0369a1; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #dbeafe; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ§° ØªØ³Ø¬ÙŠÙ„ Ø¬Ù‡Ø§Ø² Ø¬Ø¯ÙŠØ¯" onAction="#openAddDevicePage"
                            style="-fx-background-color: transparent; -fx-text-fill: #b45309; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #fef3c7; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ§¾ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©" onAction="#openDevicesPage"
                            style="-fx-background-color: transparent; -fx-text-fill: #7c3aed; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #f3e8ff; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ“¦ ØªØªØ¨Ù‘Ø¹ Ø§Ù„Ø³ÙŠØ±ÙŠØ§Ù„" onAction="#openSerialTracking"
                            style="-fx-background-color: transparent; -fx-text-fill: #1d4ed8; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #dbeafe; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±" onAction="#openReports"
                            style="-fx-background-color: transparent; -fx-text-fill: #0f766e; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #ccfbf1; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ› ï¸ ØµÙŠØ§Ù†Ø© ÙˆØªÙˆØ§Ù„Ù" onAction="#onScrapMaintenanceClicked"
                            style="-fx-background-color: transparent; -fx-text-fill: #dc2626; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #fee2e2; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>

                    <Button text="ðŸ’° Ø§Ù„ØªØ³Ø¹ÙŠØ±" onAction="#openPricingPage"
                            style="-fx-background-color: transparent; -fx-text-fill: #d97706; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #fef3c7; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>
                    <Button text="ðŸšš Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø®Ø§Ø±Ø¬Ø© Ù…Ù† Ø§Ù„Ù…ØµÙ†Ø¹" onAction="#openDeviceExitPage"
                            style="-fx-background-color: transparent; -fx-text-fill: #7c3aed; -fx-font-weight: 600;
                                   -fx-background-radius: 8; -fx-border-color: #f3e8ff; -fx-border-radius: 8;
                                   -fx-border-width: 1; -fx-cursor: hand; -fx-alignment: CENTER_LEFT;
                                   -fx-padding: 12 15 12 15;" prefWidth="250" prefHeight="45"/>
                </VBox>
            </VBox>

            <!-- Spacer -->
            <Region VBox.vgrow="ALWAYS"/>

            <!-- Logout Button in Sidebar -->
            <VBox style="-fx-padding: 20 15 20 15;">
                <Button text="ðŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬" onAction="#logout"
                        style="-fx-background-color: #fee2e2; -fx-text-fill: #dc2626; -fx-font-weight: 600;
                               -fx-background-radius: 8; -fx-border-color: #fecaca; -fx-border-radius: 8;
                               -fx-border-width: 1; -fx-cursor: hand; -fx-padding: 12 15 12 15;"
                        prefWidth="250" prefHeight="45"/>
            </VBox>
        </VBox>

        <!-- âœ… MAIN CONTENT AREA -->
        <VBox spacing="25" AnchorPane.topAnchor="20" AnchorPane.leftAnchor="295" AnchorPane.rightAnchor="25"
              AnchorPane.bottomAnchor="20" style="-fx-padding: 0 0 40 0;">

            <!-- âœ… ENHANCED HEADER -->
            <HBox spacing="20" alignment="CENTER_LEFT"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 15 25 15 25;
                         -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.08), 12, 0, 0, 3);">

                <!-- Menu Toggle Button -->
                <Button text="â˜° Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©"
                        onAction="#toggleSidebar"
                        style="-fx-background-color: #f1f5f9; -fx-text-fill: #475569; -fx-font-weight: 600;
                               -fx-background-radius: 8; -fx-border-color: #e2e8f0; -fx-border-radius: 8;
                               -fx-border-width: 1; -fx-cursor: hand; -fx-padding: 8 16 8 16;"
                        prefWidth="100" prefHeight="36"/>

                <!-- Company Info -->
                <VBox alignment="CENTER_LEFT" spacing="2">
                    <Label text="CHEM TECH"
                           style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #1e3a8a;"/>
                    <Label text="Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…"
                           style="-fx-font-size: 13px; -fx-text-fill: #64748b; -fx-font-weight: 500;"/>
                </VBox>

                <Region HBox.hgrow="ALWAYS"/>

                <!-- Status Indicators -->
                <HBox spacing="15" alignment="CENTER">
                    <!-- Database Status -->
                    <HBox alignment="CENTER" spacing="8"
                          style="-fx-background-color: #f8fafc; -fx-background-radius: 20; -fx-padding: 6 16 6 16;
                                 -fx-border-color: #e2e8f0; -fx-border-radius: 20; -fx-border-width: 1;">
                        <StackPane>
                            <Circle radius="4" fill="#10b981"/>
                        </StackPane>
                        <Label fx:id="dbStatusLabel"
                               text="Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø§ØªØµØ§Ù„..."
                               style="-fx-text-fill: #475569; -fx-font-size: 12px; -fx-font-weight: 600;"/>
                    </HBox>


                </HBox>
            </HBox>

            <!-- âœ… ENHANCED STATS CARDS -->
            <GridPane hgap="15" vgap="15">
                <columnConstraints>
                    <ColumnConstraints percentWidth="25" halignment="CENTER"/>
                    <ColumnConstraints percentWidth="25" halignment="CENTER"/>
                    <ColumnConstraints percentWidth="25" halignment="CENTER"/>
                    <ColumnConstraints percentWidth="25" halignment="CENTER"/>
                </columnConstraints>

                <!-- Total Items Card -->
                <StackPane style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);"
                           GridPane.columnIndex="0">
                    <VBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #e0f2fe; -fx-background-radius: 10; -fx-padding: 8;">
                                <Label text="ðŸ“¦" style="-fx-font-size: 16px;"/>
                            </StackPane>
                            <Label text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙ†Ø§Ù"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="totalItemsLabel" text="0"
                               style="-fx-text-fill: #0ea5e9; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>

                <!-- Low Stock Card -->
                <StackPane style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);"
                           GridPane.columnIndex="1">
                    <VBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #fef3c7; -fx-background-radius: 10; -fx-padding: 8;">
                                <Label text="âš ï¸" style="-fx-font-size: 16px;"/>
                            </StackPane>
                            <Label text="Ù…Ù†Ø®ÙØ¶Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="lowStockLabel" text="0"
                               style="-fx-text-fill: #f59e0b; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>

                <!-- Transactions Card -->
                <StackPane style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);"
                           GridPane.columnIndex="2">
                    <VBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #dcfce7; -fx-background-radius: 10; -fx-padding: 8;">
                                <Label text="ðŸ“Š" style="-fx-font-size: 16px;"/>
                            </StackPane>
                            <Label text="Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="totalTransactionsLabel" text="0"
                               style="-fx-text-fill: #22c55e; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>

                <!-- Devices Card -->
                <StackPane style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);"
                           GridPane.columnIndex="3">
                    <VBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #f3e8ff; -fx-background-radius: 10; -fx-padding: 8;">
                                <Label text="ðŸ’»" style="-fx-font-size: 16px;"/>
                            </StackPane>
                            <Label text="Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø³Ø¬Ù‘Ù„Ø©"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="totalDevicesLabel" text="0"
                               style="-fx-text-fill: #a855f7; -fx-font-size: 32px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>
            </GridPane>

            <!-- âœ… TRANSACTIONS SUMMARY -->
            <HBox spacing="15">
                <!-- IN Transactions -->
                <StackPane HBox.hgrow="ALWAYS"
                           style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);">
                    <VBox alignment="CENTER_LEFT" spacing="8" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #dbeafe; -fx-background-radius: 8; -fx-padding: 6;">
                                <Label text="â¬‡ï¸" style="-fx-font-size: 14px;"/>
                            </StackPane>
                            <Label text="Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ© (IN)"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="totalInLabel" text="0"
                               style="-fx-text-fill: #3b82f6; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>

                <!-- OUT Transactions -->
                <StackPane HBox.hgrow="ALWAYS"
                           style="-fx-background-color: white; -fx-background-radius: 12;
                                 -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);">
                    <VBox alignment="CENTER_LEFT" spacing="8" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <StackPane style="-fx-background-color: #fee2e2; -fx-background-radius: 8; -fx-padding: 6;">
                                <Label text="â¬†ï¸" style="-fx-font-size: 14px;"/>
                            </StackPane>
                            <Label text="Ø§Ù„ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…ØµØ±ÙˆÙØ© (OUT)"
                                   style="-fx-text-fill: #64748b; -fx-font-size: 14px; -fx-font-weight: 600;"/>
                        </HBox>
                        <Label fx:id="totalOutLabel" text="0"
                               style="-fx-text-fill: #ef4444; -fx-font-size: 28px; -fx-font-weight: bold;"/>
                    </VBox>
                </StackPane>
            </HBox>

            <!-- âœ… LAST TRANSACTION -->
            <StackPane style="-fx-background-color: white; -fx-background-radius: 12;
                             -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.06), 8, 0, 0, 2);">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <StackPane style="-fx-background-color: #f1f5f9; -fx-background-radius: 8; -fx-padding: 6;">
                            <Label text="ðŸ•’" style="-fx-font-size: 14px;"/>
                        </StackPane>
                        <Label text="Ø¢Ø®Ø± Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…"
                               style="-fx-text-fill: #1e293b; -fx-font-size: 16px; -fx-font-weight: bold;"/>
                    </HBox>
                    <VBox fx:id="lastTransactionContainer" spacing="8"/>
                </VBox>
            </StackPane>
        </VBox>
    </children>
</AnchorPane>